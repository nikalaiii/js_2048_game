var t={};const e=document.querySelector(".game-field").querySelector("tbody").querySelectorAll("tr"),s=document.querySelector(".start"),r=document.querySelector(".game-score"),a=document.querySelector(".restart"),i=document.querySelector(".message-start"),l=document.querySelector(".message-lose"),h=document.querySelector(".message-win");t=class{constructor(t=[]){this.state=t,this.score=0,this.status="start",this.handleKeyPress=this.handleKeyPress.bind(this)}getState(){return this.state}getStatus(){return this.status}getScore(){return r.textContent=this.score,this.score}resetBoard(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)this.state[t][e]=0;this.score=0}start(){this.status="inProcess",this.resetBoard(),this.spawnCell(),this.spawnCell(),this.changeBoard(),document.removeEventListener("keydown",this.handleKeyPress),document.addEventListener("keydown",this.handleKeyPress),s.className="button restart",s.textContent="Restart",i.remove(),h.className="message message-win hidden",l.className="message message-min hidden"}restart(){a.removeEventListener("click",this.handleRestart),this.handleRestart=()=>{this.resetBoard(),this.status="start",h.classList.add("hidden"),l.classList.add("hidden"),this.start()},a.addEventListener("click",this.handleRestart)}isGameWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)2048===this.state[t][e]&&(this.status="win",h.className="message message-win")}isGameOver(){let t=!0;for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&(t=!1),(e<3&&this.state[e][s]===this.state[e+1][s]||s<3&&this.state[e][s]===this.state[e][s+1])&&(t=!1);!0===t&&(this.status="lose",l.className="message message-lose")}handleKeyPress(t){if("inProcess"===this.status)switch(t.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}}moveDown(){let t=JSON.stringify(this.state),e=[0,1,2,3].map(t=>{let e=this.state.map(e=>e[t]).filter(t=>0!==t);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);let s=e.filter(t=>0!==t);return[...Array(4-s.length).fill(0),...s]});this.state=[0,1,2,3].map(t=>e.map(e=>e[t])),JSON.stringify(this.state)!==t&&this.spawnCell(),this.changeBoard(),this.isGameWin(),this.isGameOver(),this.getScore()}moveLeft(){let t=JSON.stringify(this.state),e=this.state.map(t=>{let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);let s=e.filter(t=>0!==t);return[...s,...Array(4-s.length).fill(0)]});this.state=e,JSON.stringify(this.state)!==t&&this.spawnCell(),this.changeBoard(),this.isGameWin(),this.isGameOver(),this.getScore()}moveRight(){let t=JSON.stringify(this.state),e=this.state.map((t,e)=>{let s=[...t].reverse().filter(t=>0!==t),r=[,,,,].fill(!1);for(let t=0;t<s.length-1;t++)s[t]!==s[t+1]||r[t]||r[t+1]||(s[t]*=2,s[t+1]=0,r[t]=!0,this.score+=s[t]);let a=s.filter(t=>0!==t);return[...a,...Array(4-a.length).fill(0)].reverse()});this.state=e,JSON.stringify(this.state)!==t&&this.spawnCell(),this.changeBoard(),this.isGameWin(),this.isGameOver(),this.getScore()}moveUp(){let t=JSON.stringify(this.state),e=[0,1,2,3].map(t=>{let e=this.state.map(e=>e[t]).filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);let s=e.filter(t=>0!==t);return[...s,...Array(4-s.length).fill(0)]});this.state=[0,1,2,3].map(t=>e.map(e=>e[t])),JSON.stringify(this.state)!==t&&this.spawnCell(),this.changeBoard(),this.isGameWin(),this.isGameOver(),this.getScore()}spawnCell(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push({x:e,y:s});if(0!==t.length){let e=Math.floor(Math.random()*t.length),{x:s,y:r}=t[e];this.state[s][r]=.9>Math.random()?2:4}}changeBoard(){for(let t=0;t<e.length;t++){let s=e[t].querySelectorAll("td");for(let e=0;e<s.length;e++){let r=this.state[t][e];0!==r?(s[e].textContent=r,s[e].className=`field-cell field-cell--${r}`):(s[e].textContent="",s[e].className="field-cell")}}}};const n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];document.addEventListener("DOMContentLoaded",()=>{var e;let s=new((e=t)&&e.__esModule?e.default:e)(n);document.querySelector(".start").addEventListener("click",()=>{s.start()})});
//# sourceMappingURL=index.3d403cd4.js.map
